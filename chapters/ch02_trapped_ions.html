<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Chapter 2 — Trapped Ionst</title>

<link rel="stylesheet" href="../css/style.css">

<script src="../js/collapsible.js"></script>

<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    }
  };
</script>
  
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<style>
.eq-placeholder {
  font-style: italic;
  color: #555;
}
</style>

</head>

<body>

<div id="sidebar-container"></div>

<script>
fetch("/Physics-for-Trapped-Ion-Quantum-Computing/includes/sidebar.html")
  .then(res => res.text())
  .then(html => {
    const container = document.getElementById("sidebar-container");
    container.innerHTML = html;
  });
</script>

<div class="content">

<div class="learning-objectives">
  <h4>Learning Objectives</h4>
  <ul>
    <li> Explain why purely static electric fields cannot stably confine charged particles, and describe how time-dependent fields circumvent this limitation.</li>
    <li> Describe the physical structure and operating principles of a linear Paul trap, including the distinct roles of RF and static electric fields.</li>
    <li> Derive the quadrupole RF potential from Laplace’s equation and electrode boundary conditions, and relate trap geometry to field curvature.</li>
    <li> Formulate and interpret the equations of motion for a trapped ion, including their reduction to the Mathieu equation and the physical meaning of the parameters $a$ and $q$.</li>
    <li> Distinguish between secular motion and micromotion, identify their characteristic timescales, and explain how micromotion depends on displacement from the RF null.</li>
    <li> Derive the pseudopotential approximation through time-scale separation and RF averaging, and justify which terms are retained or discarded using controlled approximations.</li>
  </ul>
</div> 
  
<h1>Trapped Ions</h1>

<p>
In this section we transition to discuss the physical system that will ultimately serve as the platform for our quantum computer: trapped atomic ions.
</p>
<p>
In 2000, D. P. DiVincenzo published, The physical implementation of quantum computation, in Fortschritte der Physik: Progress of Physics, 48, 771-783 which outlined five criteria for required for the realization of a quantum computer.
</p>

<p>
<b>DiVicenzo's Criteria:</b>
</p>
<p>
<b>1.(a)</b> Qubits must be well characterized and easy to produce.
</p>
<p>  
<b>(b)</b> the system must be scalable, i.e. must be able to manage an arbitrary number of qubits.
</p>
<p>
<b>2.</b> It must be possible to reliably initialize a qubit to a fiducial state, e.g. $|0\rangle$;
</p>
<p>
<b>3.</b> A qubit must be stable over timescales larger than the typical time needed to operate
on it. The lifespan of a qubit over which it can maintain its quantum information content (before noise starts to destroy it) is known as coherence time. For a viable QC
system, the coherence time of the qubit must be greater than the computation time.
</p>
<p>
<b>4.</b> It must be possible to implement a universal set of quantum gates.
</p>
<p>
<b>5.</b> A reliable procedure must exist to read out the state of a qubit.
</p>
  
<p>
While several physical platforms can, in principle, fulfill DiVincenzo’s criteria, we focus on atomic ions because many of these requirements are naturally satisfied by isolated atomic systems.
In particular, qubits encoded in internal atomic states are identical from ion to ion and do not rely on fabrication.
Atomic ion energy levels are well understood through atomic structure theory and spectroscopy in addition to being <i>"easy"</i> to produce using standard photoionization techniques.
By <i>"easy"</i> we mean in a predictable and reliable fashion.
</p>
<p>
Atomic ions satisfy the scalability criteria because each ion is an independent, identical quantum system; adding another ion therefore adds another qubit.
We will discuss <i>hardware scalability</i> in later sections as it is distinct from <i>system scalability</i>.
</p>
<p>
Reliable initialization is accomplished through optical pumping which drives atomic transitions into single internal states
via laser excitation with high fidelity. Stability is achieved with an ultra-high vacuum environment which isolate ions from uncontrolled interactions and results in long coherence times on the order seconds while
the time it takes to enact a computation occurs on the order of microseconds to milliseconds.
</p>
<p>  
A universal set of quantum gates is implemented through controlled laser excitation of the ions.
These gates are unitary operations and therefore possess the same mathematical properties discussed in Postulate 2 of quantum mechanics.
Lastly, atomic ions use state-dependent fluorescence for measurement which acts as the read out of the qubit state.
</p>

<p>
While atomic ions satisfy the requirements for a physical implementation of a quantum computer, an immediate practical question remains:
how can a device be constructed to exploit the quantum mechanical properties of atomic ions for computation?
To begin, we must consider the following: Unlike neutral atoms, ions experience strong forces in electric fields and cannot simply be left free in vacuum.
Therefore, confinement or trapping of a charged particle is critical for the physical apparatus based on atomic ions.
In the remainder of this chapter, we develop the physical principles underlying trapped-ion systems returning to DiVincenzo's criteria to come full circle.
</p>

<hr>

<h3>Earnshaw's Theorem</h3>

<p>
Since ions are charged particles confinement is both possible and nontrivial. To appreciate why ion trapping is subtle, we begin with an important limitation of classical electromagnetism known as <b>Earnshaw's Theorem</b>.
</p>

<p>
Earnshaw's Theorem states that a charged particle cannot be maintained in a <b>stable</b> equilibrium configuration by electrostatic forces alone.
Stable equilibrium implies that small perturbations on the charge do not break the equilibrium and the charge returns to its equilibrium position after perturbation.
According to Gauss' Law, the divergence of an electrostatic field is proportional to the charge density in the region so in free space the E-field is divergenceless.
</p>
  
<p>
\[
\nabla \cdot \mathbf{E} = \frac{\rho}{\varepsilon_0} = 0
\tag{2.1}
\]
</p>

<p>
Since the electric field is minus the gradient of the electric potential, the potential satisfies Laplace's equation in regions with no charge. 
</p>

<p>
\[
\mathbf{E} = -\nabla \Phi
\tag{2.2}
\]
</p>
  
<p>
Stable confinement of a charged particle in three dimensions would require the electrostatic potential to exhibit positive curvature in all directions, 
corresponding to restoring forces for small displacements. However, Laplace’s equation imposes no such condition: it requires only that the sum of the second derivatives of the potential vanish.
</p>

<p>
\[
\nabla \cdot \mathbf{E}
=
\nabla \cdot (-\nabla \Phi)
=
-\left(
\frac{\partial^2 \Phi}{\partial x^2}
+
\frac{\partial^2 \Phi}{\partial y^2}
+
\frac{\partial^2 \Phi}{\partial z^2}
\right)
=
-\nabla^2 \Phi = 0
\tag{2.3}
\]
</p>

<p>
As a result, if the curvature is positive in some directions, it must be negative in at least one other direction, leading to an instability along that direction.
</p>
<p>This means that purely static electric fields cannot trap ions in three dimensions.</p>
<hr>

<button class="collapsible">Exercise 2.1</button>
<div class="content-box">
Consider a point in free space where the electrostatic potential has positive curvature along the x-direction. Using Laplace’s equation, show that the potential must have negative curvature along at least one of the remaining directions.
</div>

<button class="collapsible">Exercise 2.2</button>
<div class="content-box">
Show that a local minimum of the electric potential is incompatible with Laplace’s equation in free space.
</div>

<button class="collapsible">Exercise 2.3</button>
<div class="content-box">
Show explicitly that the potential:
<p>
\[
\ \Phi(x,y) = x^2 - y^2
\]
</p>
satisfies Laplace’s equation in two dimensions.
</div>

  
<hr>

<h2>The Linear Paul Trap</h2>

<p>
The key insight behind ion trapping is that Earnshaw’s theorem applies to electrostatic forces. By allowing the electric potential to vary in time, it becomes possible to achieve effective confinement. Although Laplace’s equation forbids static confinement in all three spatial directions, time-dependent fields can provide dynamical stability. 
</p>
<p>
A linear Paul trap, named after Wolfgang Paul, is an ion trap which operates using rapidly oscillating electric fields at <b>radio frequencies</b> (RF). At any instant the RF quadrupole confines in only two directions, as governed by Laplace, but over many RF cycles the ion experiences a time-averaged restoring force that produces effective radial confinement. Axial confinement can then be supplied by static electric fields without violating Earnshaw’s theorem. We will show that the time-averaged motion can be stable.
</p>
<p>
The typical construction of a linear Paul trap is shown in Figure 2.1 and involves the use of both static and RF fields to achieve stability. This is done by using 4 cylindrical rods which have oscillating RF potential, with each set of diagonal rods in-phase with each other and out-of-phase with the opposite set of rods, which provide radial confinement. Additionally, to 2 static potential endcap electrodes along the $z$-axis provide axial confinement. This combination allows ions to form a linear chain along the axis without being ejected out along the $x$ or $y$ directions.
</p>
  
<figure>
  <p><i>[Figure 2.1 Placeholder: Quadrupole electrode geometry]</i></p>
</figure>
  
<p>
Paul Traps, sometimes called RF traps, are a central technology used in modern trapped-ion quantum computers. Although linear Paul traps achieve axial confinement using static endcap electrodes, fully three-dimensional Paul traps exist in which all confinement is provided dynamically by RF fields. In practice, linear traps are preferred for quantum information applications due to their superior scalability and control.
In the next section we will explore the solution to Laplace's equation under our dynamic constraint and how that informs the construction of a linear Paul trap.
</p>

  
<b>The RF Quadrupole Potential</b>
<p>
The RF quadrupole potential of the linear Paul trap is the simplest nontrivial solution to Laplace’s equation that can produce an equilibrium point using external electrodes. The RF quadrupole potential only has radial components and therefore can be expressed in the form:

<p>
\[
\Phi(x,y,t) \propto x^2 - y^2
\tag{2.4}
\]
</p>

<p>
You can verify that a potential of this form satisfies Laplace's equation. This is why the linear Paul trap consists of 4 rods; along with the axial static electrodes, it is the simplest electrode geometry which allows for charge trapping.
</p>

<p>
The full derivation involves multivariate Taylor expansion around the equilibrium position and is provided in the Appendix. Nonetheless, we provided some details to truly understand the machinery behind the scenes. After Taylor expansion around the center of the trap, we find that:
</p>
  
<p>
\[
\Phi(x,y,z,t) \approx \Phi(0,0,0,t) + \frac{1}{2} \frac{\partial^2}{\partial x^2} \Phi(0,0,0,t) x^2 + \frac{1}{2} \frac{\partial^2}{\partial y^2} \Phi(0,0,0,t) y^2 + \frac{1}{2} \frac{\partial^2}{\partial z^2} \Phi(0,0,0,t) z^2
\tag{2.5}
\]
</p>

<p>
where the $z^2$ term vanishes because the second derivative $\frac{\partial^2}{\partial z^2} \Phi(0,0,0,t)$ is zero. This is because the ideal RF quadrupole has no axial curvature, meaning that the axial confinement is not a part of the RF quadrupole potential. It is provided separately by the static endcaps which we will account for later when we build the full potential.
</p>
<p>
Now, applying this to Laplace's equation we get:
</p>
  
<p>
\[
\frac{\partial^2}{\partial x^2} \Phi(0,0,0,t) = -\frac{\partial^2}{\partial y^2} \Phi(0,0,0,t)
\tag{2.6}
\]
</p>

<p>
So that:
</p>

<p>
\[
\Phi(x,y,t) \approx \Phi(0,0,t) + \frac{1}{2} \frac{\partial^2}{\partial x^2} \Phi(0,0,t) x^2 - \frac{1}{2} \frac{\partial^2}{\partial x^2} \Phi(0,0,t) y^2
\tag{2.7}
\]
</p>
  
<p>
where we have plugged equation 2.6 into equation 2.5 and dropped the explicit $z$ dependence since it does not affect the radial confinement. If we now call $\Phi(0,0,t) = \Phi_0(t)$, we have:
</p>

<p>
\[
\Phi(x,y,t) \approx \Phi_0 + \frac{1}{2} \frac{\partial^2}{\partial x^2} \Phi_0(t) (x^2 - y^2)
\tag{2.8}
\]
</p>
  
<p>
To clean up the notation even more, we call $\frac{1}{2} \frac{\partial^2}{\partial x^2} \Phi_0(t) \Rightarrow C(t)$ so that:
</p>
  
<p>
\[
\Phi(x,y,t) \approx C(t)(x^2 - y^2) + \Phi_0(t)
\tag{2.9}
\]
</p>

<p>
Now, earlier we stated that the 4 rods of the trap are cylindrical but this is mostly due the expense of manufacturing perfectly hyperbolic trap electrodes rather than a physical constraint. In the ideal Paul trap, the surfaces of the trap rods are hyperbolas of the form $x^2 - y^2$ so that the equipotentials in inside the trap are also hyperbolas. Because equipotentials have the same value along each line, the equation must be a constant along that line, (each line would be a different constant) so that $x^2 - y^2 = \mathit{const}$. But what is this constant? To determine it, we use the ideal geometry of the trap shown in Figure 2.2
</p>
<p>
<figure>
  <p><i>[Figure 2.2 Placeholder: Quadrupole electrode geometry]</i></p>
</figure>
</p>

<p>
The standard form of a hyperbola is:
</p>
<p>
\[
\frac{x^2}{a^2} - \frac{y^2}{b^2} = 1
\tag{2.10}
\]
</p>
  
<p>
In our case, $a = b = r_0$, known as the hyperbola parameter, so that $x^2 - y^2 = r_0^2$. Then for all 4 rods we generally write:
</p>
<p>
\[
x^2 - y^2 = \pm r_0^2
\tag{2.11}
\]
</p>

<p>
Therefore, at the boudary of the rod we have:
</p>
  
<p>
\[
\Phi(x,y,t) \approx \pm C(t)r_0^2 + \Phi_0(t) \Rightarrow \begin{cases}
V_x(t) \\
V_y(t)
\end{cases}
\tag{2.12}
\]
</p>
  
<p>
where $V_x(t)$ and $V_y(t)$ are the rod potentials along the $x$ and $y$ axes, respectively.
</p>

<p>
So we have: $C(t)r_0^2 + \Phi_0(t) = V_x(t)$ and $-C(t)r_0^2 + \Phi_0(t) = V_y(t)$
</p>
  
<p>
With a bit of algebra, it can be shown that:
</p>
<p>
\[
C(t) = \frac{V_x(t) - V_y(t)}{2r_0^2}
\tag{2.13}
\]
</p>

<p>
Now, what about $\Phi_0(t)$? With a little more algebra we can show that:
</p>

<p>
\[
\Phi_0(t) = \frac{V_x(t) + V_y(t)}{2}
\tag{2.14}
\]
</p>
<p>
So in general, we have:
</p>
<p>
\[
\Phi(x,y,t) = \frac{V_x(t) - V_y(t)}{2r_0^2} (x^2 - y^2) + \frac{V_x(t) + V_y(t)}{2}
\tag{2.15}
\]
</p>

<p>
Experimentally, it is common to choose $V_x(t)$ and $V_y(t)$ such that their average is $0$. This is referred to as the <b>common-mode RF</b>. Specifically: $V_x(t) = \frac{\phi_0(t)}{2}$ and $V_y(t) = -\frac{\phi_0(t)}{2}$ where:
</p>

<p>
\[
\phi_0(t) = U + V_{RF} cos(\Omega t)
\tag{2.16}
\]
</p>
  
<p>
Here, $U$ is a DC offset parameter, $V_{RF}$ is the radio frequency voltage amplitude and $\Omega$ is the RF driving frequency.
</p>
  
<p>
Finally, after plugging in $V_x(t)$ and $V_y(t)$ into equation 2.15 we have the RF quadrupole potential for the linear Paul trap:
</p>

<p>
\[
\Phi(x,y,t) = \frac{\phi_0(t)}{2r_0^2} (x^2 - y^2)
\tag{2.17}
\]
</p>
  
<p>
This expression is commonly found in trapped-ion literature without explanation but now you understand its origin.
</p>


<p>
<b>Equations of Motion</b>
</p>

<p>
Now that we have the potential we can substitute it into the Newton's second law to reveal the equations of motion of the ion in the electric field. First recall that, $\mathbf{E} = -\nabla \Phi$, where $\Phi = \Phi(x,y,t) = \frac{\phi_0(t)}{2r_0^2} (x^2 - y^2)$. Therefore,
</p>
  
<p>
\[
E_x = -\frac{\phi_0(t)}{r_0^2} x
\tag{2.18}
\]
</p>
  <p>
\[
E_y = \frac{\phi_0(t)}{r_0^2} y
\tag{2.19}
\]
</p>
<p>
Newton's second law states:
</p>
<p>
\[
m\ddot {x} = QE_x = -Q\frac{\phi_0(t)}{r_0^2} x
\tag{2.20}
\]
</p>
<p>
\[
m\ddot {y} = QE_y = Q\frac{\phi_0(t)}{r_0^2} y
\tag{2.21}
\]
</p>
<p>
Rearranging:
</p>
<p>
\[
\ddot {x} + \frac{Q}{mr_0^2} \phi_0(t) x = 0
\tag{2.22}
\]
</p>
<p>
\[
\ddot {y} - \frac{Q}{mr_0^2}\phi_0(t) y = 0
\tag{2.23}
\]
</p>

<p>
Now plugging in $\phi_0(t)$ from equation 2.16:
</p>

<p>
\[
\ddot {x} + \frac{Q}{mr_0^2}[U + V_{RF} cos(\Omega t)] x = 0
\tag{2.24}
\]
</p>

<p>
\[
\ddot {y} - \frac{Q}{mr_0^2}[U + V_{RF} cos(\Omega t)] y = 0
\tag{2.25}
\]
</p>

<p>
We now introduce a new parameter called $\tau$ which is standard practice to match our equations of motion to the <i>Mathieu Equations</i> which were originally derived for something else entirely and might be worth a read outside of this context.
</p>
<p>
We define:
</p>

<p>
\[
\tau = \frac{\Omega t}{2} \Rightarrow \Omega t = 2 \tau
\tag{2.26}
\]
</p>

<p>
So now we have:
</p>

<p>
\[
\ddot {x} + \frac{Q}{mr_0^2}[U + V_{RF} cos(2 \tau)] x = 0
\tag{2.27}
\]
</p>

<p>
\[
\ddot {y} - \frac{Q}{mr_0^2}[U + V_{RF} cos(2 \tau)] y = 0
\tag{2.28}
\]
</p>
<p>
Since we have essentially changed variables it is worthwhile to express the time derivatives of $x$ and $y$ in terms of $\tau$. We use the chain rule for this procedure so that:
</p>
<p>
\[
\frac{dx}{dt} = \frac{dx}{d\tau} \cdot \frac{d\tau}{dt}
\tag{2.29}
\]
</p>
<p>
where $\frac{d\tau}{dt} = \frac{\Omega}{2}$
</p> 
<p>
Applying the chain rule again yields:
<p>
\[
\frac{d^2 x}{dt^2} = \frac{\Omega^2}{4} \frac{d^2 x}{d\tau^2}
\tag{2.30}
\]
</p>
<p>
So the $x$ equation becomes:
</p>
  
<p>
\[
\frac{\Omega^2}{4} \frac{d^2 x}{d\tau^2} + \frac{Q}{mr_0^2}[U + V_{RF} cos(2 \tau)] x = 0
\tag{2.31}
\]
</p>
  
<p>
Multiplying through by $\frac{4}{\Omega^2}$ yields:
</p>

<p>
\[
\frac{d^2 x}{d\tau^2} + [\frac{4QU}{mr_0^2 \Omega^2} + \frac{4QV_{RF}}{mr_0^2 \Omega^2} cos(2 \tau)] x = 0
\tag{2.32}
\]
</p>

<p>
Now, we <b>define</b> the standard Mathieu parameters:
</p>

<p>
\[
a \equiv \frac{4QU}{mr_0^2 \Omega^2}
\tag{2.33}
\]
</p>

<p>
\[
q \equiv \frac{2QV_{RF}}{mr_0^2 \Omega^2}
\tag{2.34}
\]
</p>

<p>
So that:
</p>

<p>
\[
\frac{d^2 x}{d\tau^2} + [a + 2q cos(2\tau)] x = 0
\tag{2.35}
\]
</p>
  
<p>
It is strongly encouraged that the reader perform a similar procedure to show that the $y$ equation is:
</p>

<p>
\[
\frac{d^2 y}{d\tau^2} + [-a - 2q cos(2\tau)] y = 0
\tag{2.36}
\]
</p>

<button class="collapsible">Exercise 2.4 Stability in $x$ and $y$</button>
<div class="content-box">
Explain why the signs of the Mathieu parameters differ between the $x$ and $y$ equations of motion, and relate this to Laplace’s equation.
</div>

<button class="collapsible">Exercise 2.5 Effect of RF Frequency Scaling </button>
<div class="content-box">
Suppose the RF voltage amplitude $V_{RF}$ is held fixed while the RF drive frequency $\Omega$ is increased by a factor of 2.
<p>
1. How does the Mathieu parameter $q$ change?
</p>
<p>
2. How does the secular frequency $\omega_{sec}$ change?
</p>
<p>
3. Qualitatively describe what happens to the micromotion amplitude.
</p>
</div>
  
<p>
We now make the standard approximation for the motion of the ion, meaning we approximate for a <i>small</i> $q$ value. A stability diagram of $a$ vs. $q$ displays the stable regions of an ion based on the DC offset, RF voltage amplitude, etc.
</p>

<figure>
  <p><i>[Figure 2.3 Placeholder: Stability Diagram]</i></p>
</figure>
</p>

<button class="collapsible">Exercise 2.6 Interpreting Ion Motion </button>
<div class="content-box">
A trapped ion exhibits secular motion at frequency $\omega_{sec} = 1.2 \text{MHz}$ when driven with an RF frequency $\Omega = 40 \text{MHz}$.
<p>
1. Estimate the Mathieu parameter $q$.
</p>
<p>
2. Determine whether the small-$q$  approximation is justified.
</p>
<p>
3. Explain how increasing $V_{RF}$ would affect both secular motion and micromotion.
</p>
</div>
  
<p>
The Mathieu equations are a class of linear differential equations with periodic coefficients. The general solutions to these equations are obtained using <b>Floquet’s theorem</b>, which guarantees solutions of the form of a periodic function multiplied by an exponential. Physically, this analysis explains how a rapidly oscillating field can produce stable, time-averaged confinement. We do not pursue this analysis here; a brief overview of Floquet theory and its application to the Mathieu equation is provided in the Appendix.
</p>
<p>
After applying Floquet theory, the solution to the $x$ equation is found to be:
</p>
<p>
\[
x(t) = A cos(\omega_{sec} t) [1 + \frac{q}{2} cos(\Omega t)]
\tag{2.37}
\]
</p>
<p>
where $A$ is the amplitude, $\omega_{sec} = \frac{q}{2} \frac{\Omega}{\sqrt{2}}$ is the <b>secular frequency</b> and $\Omega$ is the driving frequency. The secular frequency is responsible for the slow, overarching oscillatory motion of the ion while the driving frequency causes higher frequency oscillation known as <b>micromotion</b>. Experimentally, the driving frequency, also known as the RF drive or RF frequency (yes, sort of like saying ATM machine) can typically be from 10 - 100 MHz while the secular frequency is much smaller from around several hundred kHz to a few MHz. In trapped-ion experiments, laser cooling techniques are used to reduce the energy associated with the secular motion, since this motion corresponds to true bound oscillations of the ion in the trap. Micromotion, by contrast, is phase-locked to the RF drive and cannot be eliminated by cooling alone. While intrinsic micromotion is an unavoidable feature of RF trapping, excess micromotion arising from stray electric fields or imperfect alignment can be minimized through careful experimental compensation. Achieving low secular motion and minimal excess micromotion is essential for high-fidelity quantum control.
</p>

<p>
Note: A similar analysis leading to equation 2.37 can be done for the $y$ equation but as we shall see, we can extend the argument in 2D without loss of generality at the end of the derivation.
</p>

  
<p>
<b>The Pseudopotential</b>
</p>
<p>
As we have shown in the sections above, the electric potential in a Paul trap is explicitly time-dependent, the resulting motion of a trapped ion naturally separates into fast micromotion and slow secular motion. When the RF drive frequency is much larger than the secular frequency, the rapid oscillations can be averaged over, yielding an effective time-independent potential that governs the secular dynamics. This effective potential is known as the <b>pseudopotential</b>. While it does not describe the full instantaneous motion of the ion, the pseudopotential provides a powerful and intuitive description of confinement, allowing the secular motion to be treated as that of a particle in a static harmonic trap. In the following section, we derive this effective potential and examine the conditions under which it is valid.
</p>
<p>
We determined earlier that the equation of motion in the $x$ direction given by equation 2.24. Now we set $U = 0$ for convenience since $U$ is an experimentally controlled DC offeset parameter. (Consequently, the Mathieu parameter $a$ also becomes zero thus restricting the stability diagram to the horizontal axis). The result is:
</p>
  
<p>
\[
\ddot {x} + \frac{Q}{mr_0^2}[V_{RF} cos(\Omega t)] x = 0
\tag{2.38}
\]
</p>
  
<p>
We can split he solution into secular and micromotion:
</p>
  
<p>
\[
x(t) = \underbrace{X(t)}_\textrm{secular} + \underbrace{\xi(t)}_\textrm{micromotion}
\tag{2.39}
\]
</p>

<p>
So that:
</p>
<p>
\[
\ddot X + \ddot \xi = -\frac{Q V_{RF}}{m r_0^2}(X(t) + \xi(t)) cos(\Omega t)
\tag{2.40}
\]
</p>
<p>
Rearranging:
</p>
<p>
\[
\ddot \xi = -\frac{Q V_{RF}}{m r_0^2}[ X(t) cos(\Omega t) - \xi(t) cos(\Omega t) ] - \ddot X
\tag{2.41}
\]
</p>

<p>
To simplify this, consider the micromotion of the form:
</p>

<p>
\[
\xi = A(t) cos(\Omega t)
\tag{2.42}
\]
</p>
<p>
where $A(t)$ is the time-varying amplitude on the secular timescale. The second derivative yields:
</p>

<p>
\[
\ddot \xi = A(t) \Omega^2 cos(\Omega t) + \text{terms involving, } \dot A, \ddot A
\tag{2.43}
\]
</p>
<p>
The extra terms involve $\dot A$ and $\ddot A$ and can be dropped because $\dot A \sim \omega_{sec} A$ and $\ddot A \sim \omega_{sec}^2 A$ are suppressed by the fact that $\omega_{sec} \ll \Omega$. Therefore, to leading order:
</p>
<p>
\[
\ddot \xi \sim -\Omega^2 \xi
\tag{2.44}
\]
</p>
<p>
Similarly, the secular motion varies as $X(t) \sim X_0 cos(\omega_{sec} t)$ so that $\ddot X \sim \omega_{sec}^2 X$. Again, since $\omega_{sec} \ll \Omega$ we have:
</p>
<p>
\[
\ddot \xi \gg \ddot X
\tag{2.45}
\]
</p>
<p>
Therefore in equation 2.41 we have:
</p>
<p>
\[
\ddot \xi = -\frac{Q V_{RF}}{m r_0^2}[ X(t) cos(\Omega t) - \xi(t) cos(\Omega t) ]
\tag{2.46}
\]
</p>

<p>
Now we eliminate the $\xi(t) cos(\Omega t)$ term by considering the ratio with $\ddot \xi$ using equation equation 2.44:
</p>
  
<p>
\[
\frac{\xi(t)}{\ddot \xi} = \frac{\xi(t)}{\Omega^2 \xi(t)} = \frac{1}{\Omega^2}
\tag{2.47}
\]
</p> 
<p>
Meaning that $\xi(t) \ll \ddot \xi$ and therefore can be dropped. Finally, we have:
</p>
<p>
\[
\ddot \xi = -\frac{Q V_{RF}}{m r_0^2} X(t) cos(\Omega t)
\tag{2.48}
\]
</p> 
  
<p>
Setting equation 2.48 equal to equation 2.43 lets us solve for $A(t)$:
</p>

<p>
\[
\ddot \xi = -\frac{Q V_{RF}}{m r_0^2} X(t) cos(\Omega t) = A(t) \Omega^2 cos(\Omega t)
\]
</p>

<p>
\[
\ A(t) = -\frac{Q V_{RF}}{m r_0^2 \Omega^2} X(t)
\tag{2.49}
\]
</p> 

<button class="collapsible">Exercise 2.7</button>
<div class="content-box">
Show that if the secular displacement $X(t) = 0$, then the micromotion $\xi(t)$ vanishes identically.
Explain the physical significance of this result.
</div>
  
<p>
So finally, the mircomotion is governed by:
</p>
<p>
\[
\ \xi(t) = A(t) cos(\Omega t) = -\frac{Q V_{RF}}{m r_0^2 \Omega^2} X(t) cos (\Omega t)
\tag{2.50}
\]
</p> 

<button class="collapsible">Exercise 2.8 Displaced RF Null </button>
<div class="content-box">
Suppose a stray static electric field shifts the ion’s equilibrium position away from the RF null by a distance $x_0$.
<p>
1. Would micromotion still vanish at $X(t) = 0$?
</p>
<p>
2. How would the micromotion amplitude depend on $x_0$?
</p>
<p>
3. Explain why laser cooling cannot remove this type of micromotion.
</p>
</div>

  
<p>
Now we consider the kinetic energy of the ion:
</p>

<p>
\[
\ T = \frac{1}{2} m \dot x^2 = \frac{1}{2} (\dot X + \dot \xi)^2
\tag{2.51}
\]
</p> 

<p>
where $\dot \xi = \epsilon [(\dot X cos(\Omega t) - X \Omega sin(\Omega t)]$. We have defined $\epsilon \equiv -\frac{Q V_{RF}}{mr_0^2 \Omega^2}$ for notational convenience.
</p>

<p>
So the kinetic energy can be written:
</p>
  
<p>
\[
\ T = \frac{1}{2} m (\dot X + \epsilon \dot X cos(\Omega t) - \epsilon X \Omega sin(\Omega t))^2
\tag{2.52}
\]
</p> 
<p>
Upon expanding:
</p>

<p>
\[
\ T = \frac{1}{2} m (\dot X^2 + 2 \epsilon \dot X^2 cos(\Omega t) - 2 \epsilon \dot X X sin(\Omega t) + \epsilon^2 \dot X^2 cos^2(\Omega t) - 2 \epsilon^2 \dot X X \Omega sin(\Omega t) cos(\Omega t) + \epsilon^2 X^2 \Omega^2 sin^2(\Omega t))
\tag{2.53}
\]
</p>
  
<p>
Phew! Don't worry, many of these terms will be dropped by considering the average kinetic energy!
</p>
<p>
The average $\langle sin(\Omega t) \rangle = \langle cos(\Omega t) \rangle = 0$, $\langle sin(\Omega t)cos(\Omega t) \rangle = 0$, and $\langle sin^2(\Omega t) \rangle = \langle cos^2(\Omega t) \rangle = \frac{1}{2}$ so that we now have the average kinetic energy:
</p>

<p>
\[
\ \langle T \rangle = \frac{1}{2} m (\dot X^2 + \frac{1}{2} \epsilon^2 \dot X^2 + \frac{1}{2} \epsilon^2 X^2 \Omega^2)
\tag{2.54}
\]
</p>

<button class="collapsible">Exercise 2.9</button>
<div class="content-box">
Verify explicitly that the following terms vanish under RF averaging:$\langle sin(\Omega t) \rangle$, $\langle cos(\Omega t) \rangle$, $\langle sin(\Omega t)cos(\Omega t) \rangle$, and $\langle sin^2(\Omega t) \rangle$, $\langle cos^2(\Omega t) \rangle$
</div>
  
<p>
Notice that the second terms is suppressed because when compared with the first term, $\frac{\frac{1}{2} \epsilon^2 \dot X^2}{\dot X^2} = \frac{1}{2} \epsilon^2$ and since $\epsilon^2 \sim \frac{1}{\Omega^4}$ this term pales in comparison to $\dot X^2$.
</p>
<p>
So after dropping the second term we have:
</p>
<p>
\[
\ \langle T \rangle = \frac{1}{2} m \dot X^2 +  \underbrace{\frac{1}{4} m \epsilon^2 X^2 \Omega^2}_\textrm{Looks like potential energy!}
\tag{2.55}
\]
</p>
  
<p>
So we call it:
</p>

<p>
\[
\ U_{pseudo}(X) = \frac{1}{4} m \epsilon^2 \Omega^2 X^2
\tag{2.56}
\]
</p>

<p>
Or more explicitly, plugging $\epsilon$:
</p>

<p>
\[
\ U_{pseudo}(X) = \frac{1}{4} m \big(\frac{Q V_{RF}}{m r_0^2 \Omega^2})^2 \Omega^2 X^2 = \frac{1}{4} m \frac{Q^2 V_{RF}^2}{m^2 r_0^4 \Omega^2} X^2
\tag{2.57}
\]
</p>

<p>
Recall that $\omega_{sec} = \frac{q}{2} \frac{\Omega}{\sqrt{2}}$ where $q = \frac{2 Q V_{RF}}{m r_0^2 \Omega^2}$ so that:
</p>
\[
\ \omega_{sec} = \frac{Q V_{RF}}{m r_0^2 \Omega \sqrt{2}} \Rightarrow \omega_{sec}^2 = \frac{1}{2} \frac{Q^2 V_{RF}^2}{m^2 r_0^4 \Omega^2}
\tag{2.58}
\]
</p>

<p>
So we may finally write the harmonic pseudopotential:
</p>
<p>
\[
\ U_{pseudo}(X) = \frac{1}{2} m \omega_{sec}^2 X^2
\tag{2.59}
\]
</p>

<p>
Lastly, this can be extended to 2 dimensions yielding:
</p>
  
<p>
\[
\ U_{pseudo}(X,Y) = \frac{1}{2} m \omega_{sec}^2 (X^2 + Y^2)
\tag{2.57}
\]
</p>


<hr>
<b>The Total Potential</b>
<p>
Now we add the end caps along the axial direction for confinement in all directions. We know the end cap electrostatic potential must satisfy Laplace's Equation, but additionally the potential must be quadratic near the trap center. The most general quadratic form is:
</p>
  
<p>
\[
\ \Phi(X,Y,Z) = AX^2 + AY^2 + BZ^2
\tag{2.58}
\]
</p>
  
<p>
Where the coefficients of $X^2$ and $Y^2$ are the same because the trap is cylindrically symmetric. Taking the Laplacian and setting to zero gives:
</p>

<p>
\[
\ \nabla^2 \Phi(X,Y,Z) = \frac{\partial^2}{\partial X^2} (AX^2) + \frac{\partial^2}{\partial Y^2} (AY^2) + \frac{\partial^2}{\partial Z^2} (BZ^2) = 0
\tag{2.59}
\]
</p>

<p>
The result, as you should check, is that $B = -2A$, so that:
</p>

<p>
\[
\ \Phi(X,Y,Z) = A \big (X^2 + Y^2 - 2Z^2)
\tag{2.60}
\]
</p>

<p>
After some rearranging and redefining:
</p>

<p>
\[
\ \Phi(X,Y,Z) = C \big (2Z^2 - X^2 - Y^2)
\tag{2.61}
\]
</p>

<p>
where $C = -A$ for notational convenience. Now we determine $C$ by fixing the value of the potential at the endcaps along $z$.
</p>

<figure>
  <p><i>[Figure 2.4 Placeholder: Endcap electrode geometry]</i></p>
</figure>

<p>
Along the $z$-axis, $X = Y = 0$ and at $\pm z_0$, $\Phi \Rightarrow V_{EC}$, where $V_{EC}$ is the endcap voltage. After applying these conditions to equation 2.61 we see that:
</p>

<p>
\[
\ C = \frac{V_{EC}}{2z_0^2}
\tag{2.62}
\]
</p>
  
<p>
We include a dimensionless geometry factor, $\kappa$ to account for the real electrode shape which may not be perfectly quadratic throughout the entire trap. The Taylor expansion from earlier is done about the center of the trap. So we have:
</p>

<p>
\[
\ C = \kappa \frac{V_{EC}}{2z_0^2}
\tag{2.63}
\]
</p> 

<p>
In general, the potential is:
</p>

<p>
\[
\ \Phi(X,Y,Z) = \kappa \frac{V_{EC}}{2z_0^2} \big (2Z^2 - X^2 - Y^2)
\tag{2.64}
\]
</p> 

<p>
where $0 \lt \kappa \lt 1$. We now proceed to determine the potential energy of a single with charge, $Q$.
</p>

<p>
\[
\begin{align}
\ U_{EC}
& = Q \Phi(X,Y,Z) \\
& = \kappa \frac{Q V_{EC}}{2z_0^2} \big (2Z^2 - X^2 - Y^2) \\
& = \kappa \frac{Q V_{EC}}{z_0^2} Z^2 - \kappa \frac{Q V_{EC}}{2z_0^2} \big (X^2 + Y^2)
\tag{2.65}
\end{align}
\]
</p> 
<p>
Notice that the first term in the last line looks like a restoring quadratic potential along the $z$-axis with $\omega_z = \sqrt{\frac{2 Q V_{EC}}{mz_0^2}}$.
</p>

<p>
So we may write more concisely:
</p>

<p>
\[
\ U_{EC} = \frac{1}{2} \kappa m \omega_z^2 Z^2 - \kappa \frac{Q V_{EC}}{2z_0^2} \big (X^2 + Y^2)
\tag{2.66}
\]
</p>

<p>
Now we finally combine the potential of the endcap with the pseudopotential of the rods to get the total potential, $U_{tot} = U_{EC} + U_{pseudo}$:
</p>

<p>  
\[
\begin{align}
\ U_{tot} & = \frac{1}{2} \kappa m \omega_z^2 Z^2 - \kappa \frac{Q V_{EC}}{2z_0^2} \big (X^2 + Y^2) + \frac{1}{2} m \omega_{sec}^2 (X^2 + Y^2) \\
& = \frac{1}{2} \kappa m \omega_z^2 Z^2 + \big (- \kappa \frac{Q V_{EC}}{2 z_0^2} + \frac{1}{2} m \omega_{sec}^2) \big (X^2 + Y^2) \\
& = \frac{1}{2} \kappa m \omega_z^2 Z^2 + \frac{1}{2} m \big (- \kappa \frac{Q V_{EC}}{m z_0^2} + \omega_{sec}^2) \big (X^2 + Y^2)
\tag{2.67}
\end{align}
\]
</p>

<p>
We now define an effective secular frequency, namely, $\omega_{sec}' = \sqrt{\omega_{sec}^2 - \kappa \frac{Q V_{EC}}{m z_0^2}} = \sqrt{\omega_{sec}^2 - \frac{1}{2} \kappa \omega_z^2}$ so that:
</p>

<p>
\[
\ U_{tot} = \frac{1}{2} \kappa m \omega_z^2 Z^2 + \frac{1}{2} m \omega_{sec}'^2 \big (X^2 + Y^2)
\tag{2.68}
\]
</p>

<p>
Finally, we have the total potential of the Linear Paul trap. Going forward we will assume the ideal case which $\kappa = 1$.
</p>

  
<hr>  
<h2>Outlook: From Classical Motion to Quantum Mechanics</h2>

<p>
In this chapter we have treated the ion’s motion classically. However, once the ion is sufficiently cold, its motional degrees of freedom must be described quantum mechanically.
</p>

<p>
In the next section we will quantize the ion’s motion, introduce phonon modes, and connect this picture to the internal electronic states of the ion. These ingredients together form the foundation of trapped-ion quantum computation.
</p>

<br><br>

</div>
</body>
</html>

